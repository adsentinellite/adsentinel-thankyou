<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grazie — AdSentinel Lite</title>
  <meta name="description" content="Grazie per l’acquisto. Completa l’onboarding per attivare AdSentinel Lite." />

  <!-- Google tag (gtag.js) — Google Ads -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17475196617"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'AW-17475196617');
  </script>

  <!-- Conversione con transaction_id
       - Usa session_id / payment_intent / transaction_id dall'URL se presenti
       - Altrimenti genera un UUID stabile per la sessione (dedup sicuro) -->
  <script>
  (function () {
    try {
      var url = new URL(window.location.href);
      var tx =
        url.searchParams.get('session_id') ||        // Stripe Checkout Session (se disponibile)
        url.searchParams.get('payment_intent') ||    // Stripe PaymentIntent (se disponibile)
        url.searchParams.get('transaction_id');      // eventuale parametro custom

      // fallback: ID univoco stabile nella sessione del browser
      if (!tx) {
        tx = sessionStorage.getItem('ads_txid');
        if (!tx) {
          tx = (window.crypto && crypto.randomUUID)
                ? crypto.randomUUID()
                : (Date.now() + '-' + Math.random().toString(16).slice(2));
          sessionStorage.setItem('ads_txid', tx);
        }
      }

      // invia evento di conversione
      window.dataLayer = window.dataLayer || [];
      function gtag(){ dataLayer.push(arguments); }
      gtag('event', 'conversion', {
        'send_to': 'AW-17475196617/EynQCKUOnogbEMmt6YxB',
        'transaction_id': tx
      });
    } catch(e) {
      // in caso di errore non bloccare la pagina
      console && console.warn && console.warn('Conversion tag error:', e);
    }
  })();
  </script>

  <style>
    :root { color-scheme: dark; }
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      margin: 0; background: #0b1220; color: #fff;
    }
    .wrap{ max-width: 720px; margin: 0 auto; padding: 48px 24px; text-align: center; }
    h1{ font-size: 34px; margin: 8px 0 12px; }
    p{ opacity: .9; line-height: 1.6; }
    .card{
      background: #121b2d; border: 1px solid #21314d; border-radius: 16px;
      padding: 24px; margin-top: 24px;
    }
    a.btn{
      display: inline-block; margin-top: 16px; padding: 14px 22px;
      border-radius: 10px; text-decoration: none; background: #4f8cff;
      color: #fff; font-weight: 600;
    }
    .sm{ font-size: 12px; opacity: .7; margin-top: 18px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Grazie per l’acquisto ✅</h1>
    <p>Abbiamo ricevuto il pagamento. Per attivare AdSentinel Lite completa ora il modulo di onboarding.</p>

    <div class="card">
      <h2 style="margin:0 0 8px">Passo finale (2 minuti)</h2>
      <p>Serve il tuo <strong>Customer ID Google Ads</strong> e le soglie base.</p>
      <a class="btn"
         href="https://docs.google.com/forms/d/e/1FAIpQLSdJ3L_jW-_lqDlZ306H89Y06rw2JRaXNhAHcuJCgNWE5rYzzw/viewform?usp=header"
         target="_blank" rel="noopener">Compila il modulo</a>
      <p class="sm">Se hai già compilato il modulo, puoi chiudere questa pagina.</p>
    </div>

    <p class="sm">Supporto solo via email: adsentinel.lite@gmail.com</p>
  </div>
</body>
</html>

